---
# handlers file for sbaerlocher.common

- name: enable fstrim
  become: true
  service: name=fstrim.timer state=enable

- name: Reboot server
  shell: shutdown -r now
  async: 1
  poll: 0
  ignore_errors: true

- name: Pause for 30 seconds
  pause:
    seconds: 30

- name: Wait for reboot
  local_action: wait_for host={{ inventory_hostname }}
                port=22
                delay=15
                timeout=300
                state=started
                connect_timeout=15
